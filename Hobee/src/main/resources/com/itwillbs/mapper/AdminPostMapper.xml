<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.itwillbs.mapper.AdminPostMapper">

    <!-- ðŸ“Œ 1. ê²Œì‹œê¸€ ì „ì²´ ëª©ë¡ -->
    <select id="getPostList" resultType="com.itwillbs.domain.AdminPostVO">
        SELECT 
            post_id,
            title,
            content,
            author,
            tag,
            views,
            is_visible,
            created_at
        FROM community_content
        ORDER BY post_id DESC
    </select>


    <!-- ðŸ“Œ 2. ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ -->
    <select id="getPostDetail" resultType="com.itwillbs.domain.AdminPostVO">
        SELECT 
            post_id,
            title,
            content,
            author,
            tag,
            views,
            is_visible,
            created_at
        FROM community_content
        WHERE post_id = #{post_id}
    </select>


    <!-- ðŸ“Œ 3. ê²Œì‹œê¸€ ê³µê°œ/ìˆ¨ê¹€ í† ê¸€ -->
    <update id="togglePostVisible">
        UPDATE community_content
        SET is_visible = CASE 
                            WHEN is_visible = 1 THEN 0 
                            ELSE 1 
                         END
        WHERE post_id = #{post_id}
    </update>


    <!-- ðŸ“Œ 4. ê²Œì‹œê¸€ ì‚­ì œ -->
    <delete id="deletePost">
        DELETE FROM community_content
        WHERE post_id = #{post_id}
    </delete>

</mapper>
